<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Yuma & Seta</title>
  <link href="https://fonts.googleapis.com/css2?family=EB+Garamond&display=swap" rel="stylesheet">
  <style>
    body {
      margin: 0;
      font-family: 'EB Garamond', serif;
      background-color: #ffe6e6;
      color: #333;
    }
    header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 20px;
      background-color: #fff0f0;
    }
    header img {
      max-width: 150px;
      border-radius: 50%;
    }
    .panier-container {
      display: flex;
      align-items: center;
      cursor: pointer;
      margin-right: 20px;
      color: #990000;
      font-weight: bold;
      font-size: 18px;
    }
    .panier-container svg {
      width: 22px;
      height: 22px;
      margin-right: 6px;
      fill: #990000;
    }
    #panier {
      display: none;
      position: fixed;
      top: 80px;
      right: 20px;
      width: 300px;
      background: #fff0f0;
      padding: 20px;
      border-radius: 10px;
      box-shadow: 0 4px 10px rgba(0,0,0,0.2);
      z-index: 999;
    }
    h2 {
      margin-top: 40px;
      text-align: center;
      color: #990000;
    }
    .section {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 20px;
      padding: 20px;
    }
    .item {
      background: none;
      border-radius: 10px;
      padding: 10px;
      width: 200px;
      text-align: center;
    }
    .item img {
      width: 100%;
      aspect-ratio: 1 / 1;
      object-fit: cover;
      border-radius: 50%;
    }
    button {
      margin-top: 10px;
      padding: 10px;
      background-color: #990000;
      color: white;
      border: none;
      border-radius: 5px;
      cursor: pointer;
    }
    button:hover {
      background-color: #cc0000;
    }
    .panier-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 5px;
    }
    .supprimer {
      background-color: transparent;
      color: #990000;
      border: none;
      font-weight: bold;
      cursor: pointer;
    }
    .supprimer:hover {
      color: #cc0000;
    }
    #formulaire {
      display: none;
      padding: 20px;
      background: #fff;
      margin: 20px auto;
      max-width: 600px;
      border-radius: 10px;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
    }
    input, select {
      width: 100%;
      padding: 8px;
      margin: 10px 0;
      border-radius: 5px;
      border: 1px solid #ccc;
    }
  </style>
</head>
<body>
  <header>
    <div style="display: flex; align-items: center; gap: 10px;">
      <img src="logo.jpg.jpg" alt="Logo Yuma & Seta" />
      <h1 style="font-size: 24px; margin: 0; color: #990000;">Yuma & Seta</h1>
    </div>
    <div class="panier-container" onclick="togglePanier()">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
        <path d="M7 18c-1.1 0-1.99.9-1.99 2S5.9 22 7 22s2-.9 2-2-.9-2-2-2zm10 
                 0c-1.1 0-1.99.9-1.99 2S15.9 22 17 22s2-.9 2-2-.9-2-2-2zM7.16 
                 14l.84-2h7.45c.75 0 1.41-.41 1.75-1.03L21 4H6.21l-.94-2H1v2h2l3.6 
                 7.59-1.35 2.44C4.52 14.37 5.48 16 7 16h12v-2H7.16z"/>
      </svg>
      PANIER
    </div>
  </header>

  <h2>Bracelets</h2>
  <div class="section">
    <div class="item"><img src="Bracelet Cartier.jpg"><p>Bracelet Cartier</p><button onclick="ajouterAuPanier('Bracelet Cartier', 2600)">Ajouter au panier - 2600 DA</button></div>
    <div class="item"><img src="Bracelet Luis Vuitton.jpg.JPG"><p>Bracelet Louis Vuitton</p><button onclick="ajouterAuPanier('Bracelet Louis Vuitton', 2700)">Ajouter au panier - 2700 DA</button></div>
    <div class="item"><img src="Bracelet Serpenti.jpg"><p>Bracelet Serpenti</p><button onclick="ajouterAuPanier('Bracelet Serpenti', 1200)">Ajouter au panier - 1200 DA</button></div>
  </div>

  <div id="panier">
    <h3>Panier</h3>
    <ul id="liste-panier"></ul>
    <p>Total : <span id="total">0</span> DA</p>
    <label>Points à utiliser :
      <input type="number" id="points" value="0" oninput="mettreAJourTotal()" />
    </label>
    <p>Réduction : <span id="reduction">0</span> DA</p>
    <p>Total à payer : <span id="total-final">0</span> DA</p>
    <button onclick="afficherFormulaire()">Confirmer</button>
  </div>

  <div id="formulaire">
    <h3>Finaliser la commande</h3>
    <input type="text" id="nom" placeholder="Nom" required />
    <input type="text" id="prenom" placeholder="Prénom" required />
    <input type="text" id="instagram" placeholder="Instagram" required />
    <input type="date" id="naissance" placeholder="Date de naissance" required />
    <input type="tel" id="tel" placeholder="Numéro de téléphone" required />
    <select id="livraison" onchange="gererLivraison()" required>
      <option value="">-- Choisir un mode de livraison --</option>
      <option value="bureau">Bureau</option>
      <option value="domicile">À domicile</option>
    </select>
    <input type="text" id="wilaya" placeholder="Wilaya" required />
    <input type="text" id="adresse" placeholder="Adresse exacte" style="display: none;" />
    <button onclick="validerCommande()">Commander</button>
  </div>

  <script>
    let panier = [];

    function ajouterAuPanier(nom, prix) {
      panier.push({ nom, prix });
      mettreAJourPanier();
    }

    function supprimerDuPanier(index) {
      panier.splice(index, 1);
      mettreAJourPanier();
    }

    function mettreAJourPanier() {
      const liste = document.getElementById("liste-panier");
      liste.innerHTML = "";
      let total = 0;
      panier.forEach((item, index) => {
        const li = document.createElement("li");
        li.className = "panier-item";
        li.innerHTML = `${item.nom} - ${item.prix} DA <button class="supprimer" onclick="supprimerDuPanier(${index})">x</button>`;
        liste.appendChild(li);
        total += item.prix;
      });
      document.getElementById("total").textContent = total;
      mettreAJourTotal();
    }

    function mettreAJourTotal() {
      let points = parseInt(document.getElementById("points").value) || 0;
      let reduction = Math.round(points * 3.33);
      let total = parseInt(document.getElementById("total").textContent);
      let final = Math.max(total - reduction, 0);
      document.getElementById("reduction").textContent = reduction;
      document.getElementById("total-final").textContent = final;
    }

    function togglePanier() {
      const panierDiv = document.getElementById("panier");
      panierDiv.style.display = panierDiv.style.display === "block" ? "none" : "block";
    }

    function afficherFormulaire() {
      document.getElementById("formulaire").style.display = "block";
      document.getElementById("formulaire").scrollIntoView({ behavior: "smooth" });
    }

    function gererLivraison() {
      const livraison = document.getElementById("livraison").value;
      const adresse = document.getElementById("adresse");
      if (livraison === "domicile") {
        adresse.style.display = "block";
        adresse.required = true;
      } else {
        adresse.style.display = "none";
        adresse.required = false;
      }
    }

    function validerCommande() {
      const nom = document.getElementById("nom").value.trim();
      const prenom = document.getElementById("prenom").value.trim();
      const instagram = document.getElementById("instagram").value.trim();
      const tel = document.getElementById("tel").value.trim();
      const wilaya = document.getElementById("wilaya").value.trim();
      const naissance = document.getElementById("naissance").value;
      const livraison = document.getElementById("livraison").value;
      const adresse = document.getElementById("adresse").value.trim();
      const points = parseInt(document.getElementById("points").value) || 0;
      const reduction = Math.round(points * 3.33);
      const total = parseInt(document.getElementById("total").textContent);
      const totalFinal = Math.max(total - reduction, 0);

      if (!nom || !prenom || !instagram || !tel || !wilaya || !naissance || !livraison || (livraison === "domicile" && !adresse)) {
        alert("Veuillez remplir tous les champs obligatoires.");
        return;
      }

      const data = {
        nom, prenom, instagram, naissance, tel, wilaya,
        livraison,
        adresse: livraison === "domicile" ? adresse : "",
        articles: panier,
        total, points, reduction, totalFinal
      };

      fetch("https://script.google.com/macros/s/AKfycbynXc0P3YYNyvzXOyxcfaeGbhdZabZ9HlkZiVi-bMKO-KrddxwoY748xNFWoGH1JP3C-A/exec", {
        method: "POST",
        body: JSON.stringify(data),
        headers: { "Content-Type": "application/json" }
      })
      .then(res => res.text())
      .then(() => {
        document.body.innerHTML = "<h2 style='text-align:center; padding:50px;'>Merci pour votre commande, nous vous contacterons bientôt.</h2>";
      })
      .catch(error => {
        console.error("Erreur lors de l'envoi vers Google Sheets:", error);
        alert("Une erreur est survenue. Veuillez réessayer.");
      });
    }
  </script>
</body>
</html>
